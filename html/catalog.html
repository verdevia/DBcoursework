<!doctype html>
<html>
    <head><meta charset="utf-8"><title>Каталог</title><link rel="stylesheet" href="css/style.css"></head>
    <body>
        <header>
            <div class="menu">
                <div class="container">
                    <div class="bg"></div>
                    <a>Акаунт</a>
                    <div class="dropdown">
                        <a id="login-btn" href="ent.html">Увійти</a> <!-- Кнопка для входу -->
                        <a id="account-btn" href="account.html" style="display:none;">Кабінет</a> <!-- Кнопка для акаунта -->
                        <a id="logout-btn" href="logout" style="display:none;">Вийти</a> <!-- Кнопка для виходу -->
                    </div>
                </div>
                <div class="container">
                    <div class="bg"></div><a href="main.html">На головну</a>
                </div>
                <div class="container">
                    <div class="bg"></div><a href="catalog.html" style="text-decoration: underline;">Каталог</a>
                </div>
                <div class="container">
                    <div class="bg"></div><a href="cart.html">Кошик</a>
                </div>
            </div>
            <div class="darken"></div>
        </header>
        <div class="back" id="product-list">
            <!-- Products will be dynamically loaded here -->
        </div>
        
        <script>
             // Перевірка сесії для зміни кнопок у dropdown
             fetch('/session-status')
                   .then(response => response.json())
                   .then(data => {
                       const loginBtn = document.getElementById('login-btn');
                       const accountBtn = document.getElementById('account-btn');
                       const logoutBtn = document.getElementById('logout-btn');

                       if (data.isLoggedIn) {
                           // Якщо користувач увійшов
                           loginBtn.style.display = 'none';
                           accountBtn.style.display = 'block';
                           logoutBtn.style.display = 'block';
                       } else {
                           // Якщо користувач не увійшов
                           loginBtn.style.display = 'block';
                           accountBtn.style.display = 'none';
                           logoutBtn.style.display = 'none';
                       }
                   });
            // Fetch products from the server
            fetch('/api/products')
                .then(response => response.json())
                .then(products => {
                    const productList = document.getElementById('product-list');
                    products.forEach(product => {
                        // Create a product div
                        const productDiv = document.createElement('div');
                        productDiv.classList.add('product');

                        // Add product content
                        productDiv.innerHTML = `
                            <div class="product-container">
                                <img src="${product.image_url}" alt="Product Image" class="product-image">
                                <div class="product-details">
                                    <h3>${product.name}</h3>
                                    <p>Айді товару: ${product.product_id}</p>
                                    <p>Опис: ${product.description}</p>
                                    <p>Ціна: ${product.price}грн.</p>
                                    <p>Кількість у наявності: ${product.quantity_in_stock}</p>
                                    <p>Айді категорії: ${product.category_id}</p>
                                </div>
                            </div>
                        `;

                        // Append the product to the product list
                        productList.appendChild(productDiv);
                    });
                })
                .catch(error => {
                    console.error('Error fetching products:', error);
                });
        </script>
    </body>
</html>
